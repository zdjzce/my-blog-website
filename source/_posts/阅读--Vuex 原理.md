---
title: 阅读--Vite(7) Vuex 原理
date: 2023-06-06 16:20:00
tags:
  - 阅读
  - Vuex
categories:
  - [阅读]
---

Vue 作为 MVVM 框架包含数据、视图、视图控制层。那么一个用 Vue 编写出来的页面，无非就是由三部分组成，与前方所说的一样，数据，视图和逻辑。在很多场景下组件内的数据并不只是在自身使用，如果嵌套层级深的话仅仅使用 props 或 emit 去进行传递，数据和逻辑散落在各个组件内，将会导致数据变得难以维护。那么 Vuex 就是为了解决这个问题而出现的，它将数据和控制数据的方法进行统一的状态管理，保证状态和视图的独立。

### State
Vuex 采用了单一状态树，所有的数据都维护在一个 State 里，这意味着它是单例的，这么做的好处就是能够较好的定位特定的状态片段。在内部其实就是用 reactive 进行了包裹是响应式对象。

### Getter
有时候需要通过 State 的一些状态从而计算出状态, 它会像 computed 一样被缓存起来。使用了 Object.defineProperty 去对 Getter 属性进行拦截，拦截后执行对应的 Getter 进行返回。

### Mutations
使用 commit 方法进行提交来触发 Mutations 并且更改状态。
而 Mutations 必须是同步的，这是因为要保证能够`追踪状态的变化和保持状态的一致性`。
1. Vuex 使用了一种叫做 `状态快照` 的机制来追踪状态的变化，每当状态变化时会创建一个新的快照，如果 Mutations 是异步的，那么状态快照被创建的时候，状态可能会再次发生变化，这将导致状态快照无法准确反应状态的变化。
2. 保持状态一致性：如果允许异步的 Mutations，那么在不同的 Mutations 中，状态可能会在没有被追踪的情况下发生变化，这将导致状态的不一致性。

### Actions
提交的是 Mutations 而不是直接变更状态，可以包含任何异步的操作。